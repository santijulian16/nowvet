<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://xmlns.jcp.org/jsf/passthrough"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">
    <h:head>
        <meta charset="UTF-8"></meta>
        <meta name="viewport" content="width=device-width, user-scalable=no"></meta>
        <meta name="description" content="Gestión de servcios veterinarios"></meta>
        <meta name="keywords" content="Mascota, Veterinario, PetShop, Clínica, Peluquería, Baño"></meta>
        <meta name="author" content="Julian Bermudez, Leonardo Fandiño"></meta>
        <title>Modificar Usuario</title>
        <link rel="stylesheet" type="text/css" href="../../css/estilos.css"></link>
        <link rel="icon" href="../../imagenes/favicon.ico" type="image/x-icon"></link>
        <link rel="stylesheet" type="text/css" href="../../css/font-awesome.css"></link>
        <link rel="stylesheet" type="text/css" href="../../css/bootstrap.css"></link>
        <link rel="stylesheet" type="text/css" href="../../css/jquery.datetimepicker.css"></link>
        <script src="../../js/jquery-1.11.3.min.js"></script>
        <script src="../../js/bootstrap.js"></script>
        <script src="../../js/jquery.datetimepicker.full.js"></script>
        <script src="../../js/bootstrap-datepicker.min.js"></script>
        <script src="../../js/Validator.js"></script>
        <script src="../../js/formValidation.min.js"></script>
        <script src="../../js/bootstrapValidator.js"></script>
        <script src="../../js/es_ES.js"></script>
        <script src="../../js/bootstrap-table.js"></script>
        <link href="../../css/formValidation.css" rel="stylesheet" type="text/css"/>
        <script>
            $().ready(function () {
                $('#modificarDatosUsu').formValidation({
                    err: {container: 'tooltip'},
                    icon: {valid: 'fa fa-check-circle', invalid: 'fa fa-times-circle', validating: 'fa fa-refresh'},
                    locale: 'es_ES',
                    fields: {
                        'modificarDatosUsu:nombre': {
                            row: '.form-group',
                            validators: {
                                notEmpty: {},
                                regexp: {
                                    regexp: '^[A-Za-z ñÑáéíúó]+$',
                                    message: 'Solo letra, sin números o caracteres especiales'
                                },
                                stringLength: {
                                    min: 3,
                                    max: 15
                                }
                            }
                        },
                        'modificarDatosUsu:apellido': {
                            row: '.form-group',
                            validators: {
                                notEmpty: {},
                                regexp: {
                                    regexp: '^[A-Za-z ñÑáéíúó]+$',
                                    message: 'Solo letras, sin números o caracteres especiales'
                                },
                                stringLength: {
                                    min: 3,
                                    max: 30
                                }
                            }
                        },
                        'modificarDatosUsu:cedula': {
                            row: '.form-group',
                            validators: {
                                notEmpty: {},
                                regexp: {
                                    regexp: /^[0-9]+$/,
                                    message: 'Solo números, sin caracteres especiales'
                                },
                                stringLength: {
                                    min: 2,
                                    max: 11
                                }
                            }
                        },
                        'modificarDatosUsu:correo': {
                            row: '.form-group',
                            validators: {
                                notEmpty: {},
                                emailAddress: {
                                    message: 'Ingrese un correo electronico valido'
                                },
                                regexp: {
                                    regexp: '^[^@\\s]+@([^@\\s]+\\.)+[^@\\s]+$',
                                    message: 'Ingrese un correo electronico valido'
                                }
                            }
                        },
                        'modificarDatosUsu:direccion': {
                            row: '.form-group',
                            validators: {
                                regexp: {
                                    regexp: '^[A-Za-z0-9# ,-]+$',
                                    message: 'Solo letras minusculas sin caracteres especiales'
                                }
                            }
                        },
                        'modificarDatosUsu:estado': {
                            row: '.form-group',
                            validators: {
                                notEmpty: {},
                            }
                        }

                    }
                });
            });
        </script>
        <f:event listener="#{controladorUsuario.miraSession('admin')}" type="preRenderView"></f:event>
    </h:head>
    <h:body>
        <h:form>
            <nav class="navbar navbar-default navbar-fixed-top" id="navAdmin">
                <div class="container-fluid">
                    <!-- Brand and toggle get grouped for better mobile display -->
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                            <span class="sr-only">Toggle navigation</span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                        <a class="navbar-brand" href="../indexAdministrador.xhtml">
                            <img alt="Brand" src="../../imagenes/logo.png" width="132px" height="90px" />
                        </a>
                    </div>

                    <!-- Collect the nav links, forms, and other content for toggling -->
                    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                        <ul class="nav navbar-nav navbar-right">
                            <li><h:link value="Inicio" outcome="/administrador/indexAdministrador" /></li>
                            <li><a href="../citas/misCitas.xhtml">Citas</a></li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Perfiles <span class="caret"></span></a>
                                <ul class="dropdown-menu">
                                    <li><h:link value="Gestión De Perfiles" outcome="/administrador/perfiles/gestionPerfiles" /></li>
                                    <li><h:link value="Mi Perfil" outcome="/administrador/perfiles/miPerfil" /></li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Reportes
                                    <span class="caret"></span></a>
                                <ul class="dropdown-menu">
                                    <!--<li><a href="reportes/reporteClientes.html">Reporte de clientes</a></li>-->
                                    <li><a href="../reportes/reportesCitas.xhtml">Reporte de citas</a></li>
                                    <li><h:link value="Reporte de servicios" outcome="/administrador/reportes/reportesServicios"></h:link></li>
                                    <li><h:link value="Auditoria" outcome="/administrador/reportes/auditoria" /></li>
                                </ul>
                            </li>
                            <li><h:commandLink action="#{controladorUsuario.cerrarSesion()}" >Salir&nbsp;<i class=" fa fa-sign-out"></i></h:commandLink></li>
                        </ul>
                    </div><!-- /.navbar-collapse -->
                </div><!-- /.container-fluid -->
            </nav>
        </h:form>
        <section>
            <c:if test="#{controladorUsuario.estado eq '8'}">
                <div class="alert alert-success alert-dismissible" role="alert">
                    <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <strong>¡Alerta!</strong> Rol eliminado con éxito
                </div>
            </c:if>
            <div class="container" id="colorbase">	
                <div class="row">
                    <div class="col-md-12 col-sm-12 col-xs-12" id="migasAdmin">
                        <h:link value="Inicio" outcome="/administrador/indexAdministrador" />\<h:link value="Gestión De Perfiles" outcome="/administrador/perfiles/gestionPerfiles" />\
                        <h:link value="Perfil" outcome="/administrador/perfiles/perfil" />\<h:link value="Modificar Usuario" outcome="/administrador/perfiles/modificarUsuario" />
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12" id="rolAdmin">
                        Rol: Administrador
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6 col-sm-6 col-xs-12">
                        <h3>Datos Personales</h3><hr></hr>
                        <h:form id="modificarDatosUsu" onkeypress="if (event.keyCode == 13) {
                                    document.getElementById('modificarDatosUsu:botonModificarUsuario').click();
                                    return false;
                                }">
                            <div class="form-group">
                                <label for="cedula">Cedula</label>
                                <input id="cedula" class="form-control" readonly="true" value="#{controladorUsuario.usuTemp.cedula}"></input>
                            </div>
                            <div class="form-group">
                                <h:outputLabel for="nombre">Nombre</h:outputLabel>
                                <h:inputText id="nombre" class="form-control" value="#{controladorUsuario.usuTemp.nombres}"></h:inputText>
                            </div>
                            <div class="form-group">
                                <h:outputLabel for="apellido">Apellido</h:outputLabel>
                                <h:inputText id="apellido" class="form-control" value="#{controladorUsuario.usuTemp.apellidos}"></h:inputText>
                            </div>
                            <div class="form-group">
                                <h:outputLabel for="correo">Correo</h:outputLabel>
                                <h:inputText id="correo" class="form-control" value="#{controladorUsuario.usuTemp.correo}"></h:inputText>
                            </div>
                            <div class="form-group">
                                <h:outputLabel for="direccion">Direccion</h:outputLabel>
                                <h:inputText id="direccion" class="form-control" value="#{controladorUsuario.usuTemp.direccion}"></h:inputText>
                            </div>
                            <div class="form-group">
                                <h:outputLabel for="estado">Estado</h:outputLabel>
                                <h:selectOneMenu class="form-control" value="#{controladorUsuario.usuTemp.estado}" id="estado">
                                    <f:selectItem itemValue="Activo" itemLabel="Activo"></f:selectItem>
                                    <f:selectItem itemValue="Inactivo" itemLabel="Inactivo"></f:selectItem>
                                </h:selectOneMenu>
                            </div>
                            <h:commandButton id="botonModificarUsuario" value="Modificar" action="#{controladorUsuario.modificarUsu()}" class="btn btn-success pull-right"></h:commandButton><br></br><br></br>
                        </h:form>
                    </div>
                    <div class="col-md-6 col-sm-6 col-xs-12">
                        <h3>Roles</h3><hr></hr>
                        <h:form>
                            <c:forEach var="roles" items="#{controladorUsuario.usuTemp.rolesCollection}">
                                <c:if test="#{controladorUsuario.usuTemp.rolesCollection.size() == 1}">
                                    <big><strong>#{roles.nombre}</strong></big><br></br><br></br>
                                </c:if>
                                <c:if test="#{controladorUsuario.usuTemp.rolesCollection.size() == 2}">
                                    <h:commandButton class="btn btn-danger" value="Eliminar" action="#{controladorUsuario.eliminarRol(roles)}"></h:commandButton>&nbsp;<big><strong>#{roles.nombre}</strong></big><br></br><br></br>
                                </c:if>
                            </c:forEach>
                        </h:form>
                        <button type="button" class="btn btn-default" data-toggle="modal" data-target="#modalAgregarRol">
                            <i class="fa fa-plus"></i>&nbsp;Agregar Rol
                        </button>
                        <br></br>
                        <br></br>
                    </div>

                </div>
            </div>

            <!--modal agregar rol-->
            <div class="modal fade" id="modalAgregarRol" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                            <h4 class="modal-title" id="myModalLabel">Agregar Rol</h4>
                        </div>

                        <div class="modal-body">
                            <h:form id="tipoDeRol">
                                <p>Por favor escoja el rol que desea asignar</p>
                                <div class="form-group">
                                    <div class="input-group margin-bottom-sm">
                                        <span class="input-group-addon"><i class="fa fa-user-plus"></i></span>
                                        <h:selectOneMenu class="form-control" value="#{controladorUsuario.rolTemp}">
                                            <f:selectItem itemValue="0" itemLabel="Seleccionar Rol" ></f:selectItem>
                                            <c:forEach var="rol" items="#{controladorUsuario.listarRolesDisponiblies()}">
                                                <f:selectItem itemValue="#{rol.idRol}" itemLabel="#{rol.nombre}"></f:selectItem>
                                            </c:forEach>
                                            <f:ajax render="datos" execute="@this" />
                                        </h:selectOneMenu>
                                    </div>
                                </div>
                            </h:form>
                            <h:form id="datos" onkeypress="if (event.keyCode == 13) {
                                        document.getElementById('datos:botonAgregarRol').click();
                                        return false;
                                    }">
                                <c:if test="#{controladorUsuario.rolTemp == 2}">
                                    <div class="form-group">
                                        <label for="cargo">Cargo</label>
                                        <div class="input-group margin-bottom-sm">
                                            <span class="input-group-addon"><i class="fa fa-user-md"></i></span>
                                            <input type="text" id="cargo" name="cargo" class="form-control" />
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="horaEntrada">Hora De Entrada</label>
                                        <div class="input-group margin-bottom-sm">
                                            <span class="input-group-addon"><i class="fa fa-clock-o"></i></span>
                                            <input onfocus="this.blur()" type="text" id="horaEntrada" name="horaEntrada" class="form-control" />                           
                                        </div>
                                    </div>
                                    <script>
                                        $('#horaEntrada').datetimepicker({
                                            datepicker: false,
                                            defaultTime: '00:00',
                                            format: 'H:i',
                                            step: 60
                                        });
                                    </script>
                                    <div class="form-group">
                                        <label for="horaSalida">Hora De Salida</label>
                                        <div class="input-group margin-bottom-sm">
                                            <span class="input-group-addon"><i class="fa fa-clock-o"></i></span>
                                            <input onfocus="this.blur()" type="text" id="horaSalida" name="horaSalida" class="form-control" />
                                        </div>
                                    </div>
                                    <script>
                                        $('#horaSalida').datetimepicker({
                                            datepicker: false,
                                            defaultTime: '23:00',
                                            format: 'H:i',
                                            step: 60
                                        });
                                    </script>
                                    <div class="form-group">
                                        <h:commandButton id="botonAgregarRol" class="btn btn-success" action="#{controladorUsuario.agregarRol()}" value="Agregar Rol"></h:commandButton>
                                    </div>
                                </c:if>
                                <c:if test="#{controladorUsuario.rolTemp == 1}">
                                    
                                    <div class="form-group">
                                        <label for="barrio">Barrio</label>
                                        <div class="input-group margin-bottom-sm">
                                            <span class="input-group-addon"><i class="fa fa-envelope-o fa-arrows-alt"></i></span>
                                            <input class="form-control" id="barrio" name="barrio"></input>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <h:commandButton id="botonAgregarRol" class="btn btn-success" action="#{controladorUsuario.agregarRol()}" value="Agregar Rol"></h:commandButton>
                                    </div>
                                </c:if>
                            </h:form>
                        </div>

                    </div>
                </div>
            </div>
        </section>
        <footer style="min-height: 160px !important;">
            <div id="footer-contenedor" class="row">
                <div class="col-md-8 col-md-offset-2 col-sm-10 col-sm-offset-1 col-xs-12">
                    <div id="panel1Footer" class="col-md-4 col-sm-4 col-xs-12">
                        <h3>UBICACIÓN</h3>
                        <span class=" fa fa-home"></span>&nbsp;&nbsp;Carrera 92 # 147 - 31<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Suba La Campiña<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Bogota Colombia
                    </div>
                    <div id="panel2Footer" class="col-md-4 col-sm-4 col-xs-12">
                        <h3>CONTÁCTENOS</h3>
                        <div class="row">
                            <span class=" fa fa-phone"></span>&nbsp;&nbsp;Teléfono: 6826731
                        </div>
                        <div class="row">
                            <div id="redesSociales">
                                <a href="https://www.facebook.com/clinicaveterinaria.santaisabel" target="_blank"><span class=" fa fa-facebook-square"></span></a>
                                <a href="https://twitter.com/@vetsantaisabel" target="_blank"><span class=" fa fa-twitter-square"></span></a>
                                <a href="https://plus.google.com/107918889656404618563" target="_blank"><span class=" fa fa-google-plus-square"></span></a>
                                <a href="mailto:jsbermudez381@misena.edu.co"><span class=" fa fa-envelope-o"></span></a>
                            </div>
                        </div>
                    </div>

                    <div id="panel1Footer" class="col-md-4  col-sm-4 col-xs-12">
                        <h3>INFORMACIÓN LEGAL</h3>
                        Now Vet | Todos los derechos reservados
                        <br /> &#169; Copyright 2016
                    </div>
                </div>
                <br /><br /><br /><br /><br /><br /><br /><br />
            </div>
        </footer>
    </h:body>
</html>

